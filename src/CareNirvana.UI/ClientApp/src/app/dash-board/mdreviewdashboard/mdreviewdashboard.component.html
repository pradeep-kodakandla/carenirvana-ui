
<div class="main-wrapper">
  <div class="container">
    <!-- LEFT COLUMN (20%) -->
    <div class="col-left" [ngClass]="{ 'full-width': !selectedAuth }">
      <div class="top-bar">
        <div class="search-section">
          <input type="text" placeholder="🔍 Search..." (input)="onSearch($event)" class="search-input" />
        </div>

        <!-- Summary Cards -->
        <div class="summary-container" style="padding-left:10px;" *ngIf="!selectedAuth">
          <mat-card class="summary-card" *ngFor="let item of summaryStats">
            <div class="summary-row">
              <mat-icon>{{ item.icon }}</mat-icon>
              <span class="stat-label">{{ item.label }}:</span>
              <span class="stat-value">{{ item.value }}</span>
            </div>
          </mat-card>
        </div>
      </div>
      <div class="card-list">
        <div *ngFor="let auth of auths; let i = index"
             class="card"
             [class.selected]="isSelected(i)"
             (click)="onReviewClick(i)">
          <div class="card-header">
            <strong>{{ auth.firstName }} {{ auth.lastName }}</strong>
            <button class="review-btn" (click)="onReviewClick(i); $event.stopPropagation()">Review</button>
          </div>
          <div class="card-fields">
            <div class="field">
              <label>Auth #:</label>
              <span>{{ auth.authNumber }}</span>
            </div>
            <div class="field">
              <label>Auth Type:</label>
              <span>{{ auth.authType }}</span>
            </div>
            <div class="field" *ngIf="!selectedAuth">
              <label>Review Due Date:</label>
              <span>{{ auth.dueDate }}</span>
            </div>
            <div class="field">
              <label>Review Priority:</label>
              <span>{{ auth.priority }}</span>
            </div>
            <div class="field" *ngIf="!selectedAuth">
              <label>Member ID:</label>
              <span>{{ auth.authType }}</span>
            </div>
            <div class="field" *ngIf="!selectedAuth">
              <label>Member Name:</label>
              <span>{{ auth.authType }}</span>
            </div>
            <div class="field" *ngIf="!selectedAuth">
              <label>Eligibility:</label>
              <span>{{  auth.authType}}</span>
            </div>
            <div class="field" *ngIf="!selectedAuth">
              <label>Treatment Type:</label>
              <span>{{ auth.authType }}</span>
            </div>
            <div class="field" *ngIf="!selectedAuth">
              <label>Provider ID:</label>
              <span>{{ auth.authType }}</span>
            </div>
            <div class="field" *ngIf="!selectedAuth">
              <label>Auth Due Date:</label>
              <span>{{ auth.authType }}</span>
            </div>
          </div>


        </div>
      </div>
    </div>

    <!-- MIDDLE COLUMN (40%) -->
    <div class="col-middle" *ngIf="selectedAuth">
      <div class="review-header-bar">
        <h2>Authorization Review</h2>
        <div class="review-controls">
          <button (click)="onPrevious()" [disabled]="selectedIndex === 0">&lt; Previous</button>
          <span>Review {{ selectedIndex! + 1 }} of {{ auths.length }}</span>
          <button (click)="onNext()" [disabled]="selectedIndex === auths.length - 1">Next &gt;</button>
        </div>
      </div>

      <div class="review-header">
        <p>Review Due Date: {{ selectedAuth.dueDate }} | Review Priority: {{ selectedAuth.priority }}</p>
        <p style="color:green;"><strong>Overall Initial Recommendation:</strong> {{ selectedAuth.recommendation }}</p>
      </div>

      <div class="review-content">
        <h6>Clinical Context & Instructions</h6>
        <h6>Clinical Documents</h6>
        <div class="clinical-documents">
          <div class="field">
            <label>Member ID:</label>
            <span>{{ selectedAuth.memberId }}</span>
          </div>

          <div class="field">
            <label>Member Name:</label>
            <span>{{ selectedAuth.memberId }}</span>
          </div>
          <div class="field">
            <label>Auth #:</label>
            <span>{{ selectedAuth.authNumber }}</span>
          </div>
          <div class="field">
            <label>Auth Type:</label>
            <span>{{ selectedAuth.authType }}</span>
          </div>
          <div class="field">
            <label>Facility:</label>
            <span>{{ selectedAuth.facility }}</span>
          </div>
          <div class="field">
            <label>Network Status:</label>
            <span>{{ selectedAuth.networkStatus }}</span>
          </div>
        </div>


        <h6>Service Lines</h6>
        <table class="service-table">
          <thead>
            <tr>
              <th>Code</th>
              <th>Description</th>
              <th>From</th>
              <th>To</th>
              <th>Req.</th>
              <th>Appr.</th>
              <th>Denied</th>
              <th>Initial Recommendation</th>
              <th>MD's Recommendation</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let line of selectedAuth.serviceLines">
              <td><a href="#">{{ line.code }}</a></td>
              <td>{{ line.desc }}</td>
              <td>{{ line.from }}</td>
              <td>{{ line.to }}</td>
              <td>{{ line.req }}</td>
              <td>{{ line.appr }}</td>
              <td>{{ line.denied }}</td>
              <td>{{ line.initial }}</td>
              <td>{{ line.director }}</td>
            </tr>
          </tbody>
        </table>

        <h6>Medical Director's Decision</h6>
        <div class="decision-options">
          <label><input type="radio" name="decision"> <span class="green">Approve</span></label><br />
          <label><input type="radio" name="decision"> <span class="red">Deny</span></label><br />
          <label><input type="radio" name="decision"> <span class="blue">Request more information</span></label>
        </div>

        <textarea rows="4" placeholder="Comments and Recommendations"></textarea>

        <div class="action-buttons">
          <button class="submit">Submit Decision</button>
          <button class="save">Save & Continue</button>
          <button class="close" (click)="closeReview()">Close</button>
        </div>
      </div>
    </div>


    <!-- RIGHT COLUMN (40%) -->
    <div class="col-summary" *ngIf="selectedAuth">
      <h3>Auth Summary</h3>
      <p><strong>Member ID:</strong> {{ selectedAuthData.memberId }}</p>
      <p><strong>Member Name:</strong> {{ selectedAuthData.memberName }}</p>
      <p><strong>Auth #:</strong> {{ selectedAuthData.authNumber }}</p>
      <p><strong>Auth Type:</strong> {{ selectedAuthData.authType }}</p>
      <p><strong>Facility:</strong> {{ selectedAuthData.facility }}</p>
      <p><strong>Request Date:</strong> {{ selectedAuthData.requestDate }}</p>
      <p><strong>Expected Admission:</strong> {{ selectedAuthData.expectedAdmissionDatetime }}</p>
      <p><strong>Expected Discharge:</strong> {{ selectedAuthData.expectedDischargeDatetime }}</p>

      <h4>Diagnosis</h4>
      <ul>
        <li *ngFor="let dx of selectedAuthData.diagnosisDetails">{{ dx.icd10Code }} - {{ dx.icd10Description }}</li>
      </ul>

      <h4>Notes</h4>
      <ul>
        <li *ngFor="let note of selectedAuthData.authorizationNotes">
          <strong>{{ note.authorizationNoteTypeLabel }}:</strong> {{ note.authorizationNotes }}
        </li>
      </ul>
    </div>
  </div>
</div>

