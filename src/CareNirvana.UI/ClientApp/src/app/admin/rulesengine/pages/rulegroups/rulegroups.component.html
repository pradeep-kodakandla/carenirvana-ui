<div class="rghead">
  <div class="h2">Rule Groups</div>
  <button class="btn primary" (click)="onNewGroup()">+ New Group</button>
</div>

<div class="card formcard" *ngIf="showForm">
  <div class="formtitle">{{ isEditMode ? 'Edit Rule Group' : 'Create Rule Group' }}</div>

  <form [formGroup]="form">
    <div class="formgrid">
      <div class="flfield">
        <input class="flinput" placeholder=" " formControlName="name" />
        <label class="fllabel">Rule Group Name</label>
      </div>

      <div class="flfield filled">
        <div class="activeRow">
          <label class="activeLabel">Active</label>
          <label class="switch">
            <input type="checkbox" formControlName="activeFlag" />
            <span class="slider"></span>
          </label>
        </div>
      </div>

      <div class="flfield full">
        <textarea class="fltextarea" rows="4" placeholder=" " formControlName="description"></textarea>
        <label class="fllabel">Description</label>
      </div>
    </div>

    <div class="formactions">
      <button type="button" class="btn" (click)="onCancel()">Cancel</button>
      <button type="button" class="btn primary" (click)="onSave()">
        {{ isEditMode ? 'Update' : 'Save' }}
      </button>
    </div>
  </form>
</div>

<div class="empty" *ngIf="!showForm && groups.length === 0">
  <div class="emptytitle">No Rule Groups</div>
  <div class="emptytext">Click New Group to create your first rule group.</div>
</div>

<div class="rggrid" *ngIf="groups.length > 0">
  <div class="card rgcard" *ngFor="let g of groups">
    <div class="rgtitle">{{ g.name }}</div>

    <div class="rgmeta">
      <div class="metarow">
        <b>Status:</b>
        <span class="pill" [class.off]="!g.activeFlag">{{ g.activeFlag ? 'Active' : 'Inactive' }}</span>
      </div>
      <div class="metarow"><b>Description:</b> {{ g.description }}</div>
    </div>

    <div class="assigned">
      <div class="assignedtitle">Assigned Rules ({{ getAssignedRules(g.id).length }})</div>

      <div class="assignedempty" *ngIf="getAssignedRules(g.id).length === 0">No rules assigned</div>

      <div class="assignedlist" *ngIf="getAssignedRules(g.id).length > 0">
        <div class="assigneditem" *ngFor="let r of getAssignedRules(g.id)">
          <div class="assignedname">{{ r.name }}</div>
          <div><span class="pill">{{ r.ruleType }}</span></div>
        </div>
      </div>
    </div>

    <div class="rgactions">
      <button class="btnwide" (click)="onEdit(g)">Edit</button>
      <button class="btnwide danger" (click)="onDelete(g)">Delete</button>
    </div>
  </div>
</div>
